(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,n){e.exports=n(36)},34:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),i=n.n(o),s=n(8),c=n(9),l=n(12),u=n(10),d=n(11),h=n(39),m=n(38),f=n(4),p=n(5),g={apiUrl:"http://localhost:4000"};var b={login:function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};return fetch("".concat(g.apiUrl,"/users/authenticate"),n).then(E).then(function(e){return e.token&&localStorage.setItem("user",JSON.stringify(e)),e})},logout:v,getAll:function(){var e={method:"GET",headers:function(){var e=JSON.parse(localStorage.getItem("user"));return e&&e.token?{Authorization:"Bearer "+e.token}:{}}()};return fetch("".concat(g.apiUrl,"/users"),e).then(E)}};function v(){localStorage.removeItem("user")}function E(e){return e.text().then(function(t){var n=t&&JSON.parse(t);if(!e.ok){401===e.status&&v();var a=n&&n.message||e.statusText;return Promise.reject(a)}return n})}var w=n(13),O=Object(w.a)(),S={login:function(e,t){return function(n){n({type:"LOGIN_REQUEST",user:{email:e}}),b.login(e,t).then(function(e){n(function(e){return{type:"LOGIN_SUCCESS",user:e}}(e)),O.push("/")},function(e){n(function(e){return{type:"LOGIN_FAILURE",error:e}}(e)),console.log(e)})}},logout:function(){return b.logout(),{type:"LOGOUT"}},getAll:function(){return function(e){e({type:"GETALL_REQUEST"}),b.getAll().then(function(t){return e(function(e){return{type:"GETALL_SUCCESS",users:e}}(t))},function(t){return e(function(e){return{type:"GETALL_FAILURE",error:e}}(t))})}}};var y=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props.dispatch(S.logout()),n.state={email:"",password:"",submitted:!1,err:""},n.handleCancel=n.handleCancel.bind(Object(f.a)(Object(f.a)(n))),n.handleSubmit=n.handleSubmit.bind(Object(f.a)(Object(f.a)(n))),n.onEmailChange=n.onEmailChange.bind(Object(f.a)(Object(f.a)(n))),n.onPasswordChange=n.onPasswordChange.bind(Object(f.a)(Object(f.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({submitted:!0});var t=this.state,n=t.email,a=t.password,r=this.props.dispatch;""===n&&""===a?this.setState(function(){return{err:"Please enter email / password"}}):""===n?this.setState(function(){return{err:"Please enter email"}}):""===a?this.setState(function(){return{err:"Please enter password"}}):n&&a&&r(S.login(n,a))}},{key:"handleCancel",value:function(e){this.setState(function(){return{email:"",password:""}}),document.getElementById("login-page").reset()}},{key:"onEmailChange",value:function(e){var t=e.target.value;this.setState(function(){return{email:t}})}},{key:"onPasswordChange",value:function(e){var t=e.target.value;this.setState(function(){return{password:t}})}},{key:"render",value:function(){var e=this.state,t=e.email,n=e.password,a=e.err;return r.a.createElement("div",{className:"main"},r.a.createElement("form",{id:"login-page",name:"form",action:"action_page.php",onSubmit:this.handleSubmit},r.a.createElement("label",null,r.a.createElement("b",null,"Email Id")),r.a.createElement("br",null),r.a.createElement("input",{type:"text",placeholder:"Enter email",name:"uname",value:t,onChange:this.onEmailChange}),r.a.createElement("br",null),r.a.createElement("label",null,r.a.createElement("b",null,"Password")),r.a.createElement("br",null),r.a.createElement("input",{type:"password",placeholder:"Enter Password",name:"psw",value:n,onChange:this.onPasswordChange}),r.a.createElement("br",null),a&&r.a.createElement("p",{className:"error"},a),r.a.createElement("button",{className:"loginButton",type:"submit"},"Login")),r.a.createElement("button",{className:"cancelbtn",onClick:this.handleCancel},"clear"))}}]),t}(r.a.Component),j=Object(p.b)(function(e){return{loggedIn:e.authentication.loggedIn}})(y),N=n(37),k=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(S.getAll())}},{key:"handleLogout",value:function(){this.props.dispatch(S.logout())}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"header"},"Successfully Logged in!!!"),r.a.createElement(N.a,{onClick:this.handleLogout.bind(this),className:"cancelbtn",to:"/"},"Logout"))}}]),t}(r.a.Component),C=Object(p.b)(function(e){var t=e.users;return{user:e.authentication.user,users:t}})(k),L=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=localStorage.getItem("user");return r.a.createElement(h.a,{history:O},r.a.createElement("div",null,r.a.createElement(m.a,{path:"/index.html",component:j}),e?r.a.createElement(m.a,{path:"/",component:C,user:e}):r.a.createElement(m.a,{path:"/",component:j,exact:!0})))}}]),t}(r.a.Component),T=Object(p.b)(function(e){var t=e.users;return{user:e.authentication.user,users:t}})(L),I=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function U(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}n(34);var A=n(7),P=n(21),G=JSON.parse(localStorage.getItem("user")),_=G?{loggedIn:!0,user:G}:{};var R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_REQUEST":return{loggingIn:!0,user:t.user};case"LOGIN_SUCCESS":return{loggedIn:!0,user:t.user};case"LOGIN_FAILURE":case"LOGOUT":return{};default:return e}},J=Object(A.c)({authentication:R,users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GETALL_REQUEST":return{loading:!0};case"GETALL_SUCCESS":return{items:t.users};case"GETALL_FAILURE":return{error:t.error};default:return e}}}),x=Object(A.d)(J,Object(A.a)(P.a));!function(){var e=[{id:1,email:"test",password:"test",firstName:"Test",lastName:"User"},{id:2,email:"veena.rakshu@gmail.com",password:"test",firstName:"Veena",lastName:"KR"},{id:3,email:"test2",password:"test",firstName:"Test",lastName:"2"},{id:4,email:"test3",password:"test",firstName:"Test",lastName:"3"}],t=window.fetch;window.fetch=function(n,a){return new Promise(function(r,o){setTimeout(function(){if(n.endsWith("/users/authenticate")&&"POST"===a.method){var i=JSON.parse(a.body),s=e.filter(function(e){return e.email===i.email&&e.password===i.password});if(s.length){var c=s[0],l={id:c.id,email:c.email,firstName:c.firstName,lastName:c.lastName,token:"fake-jwt-token"};r({ok:!0,text:function(){return Promise.resolve(JSON.stringify(l))}})}else o("Email or password is incorrect")}else n.endsWith("/users")&&"GET"===a.method?a.headers&&"Bearer fake-jwt-token"===a.headers.Authorization?r({ok:!0,text:function(){return Promise.resolve(JSON.stringify(e))}}):o("Unauthorised"):t(n,a).then(function(e){r(e)})},500)})}}(),i.a.render(r.a.createElement(p.a,{store:x},r.a.createElement(T,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");I?(function(e,t){fetch(e).then(function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):U(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):U(t,e)})}}()}},[[23,2,1]]]);
//# sourceMappingURL=main.8be241bf.chunk.js.map